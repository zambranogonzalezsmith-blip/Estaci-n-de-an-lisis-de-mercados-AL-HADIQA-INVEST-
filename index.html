<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Alhadiqainvest | HQ Terminal</title>
    
    <link rel="icon" type="image/jpeg" href="icon.jpg">
    <link rel="apple-touch-icon" href="icon.jpg">
    <link rel="stylesheet" href="style.css">
    
    <script src="chart-lib.js"></script>
</head>
<body class="menu-collapsed">
    
    <div id="lib-error" style="display:none; position:fixed; top:0; left:0; width:100%; background:#f23645; color:white; text-align:center; z-index:9999; padding:12px; font-family: sans-serif;">
        ‚ö†Ô∏è <strong>ERROR DE CARGA:</strong> Motor de gr√°ficos no detectado. Revise su conexi√≥n.
    </div>

    <button id="menu-toggle" onclick="toggleMenu()" title="Configuraci√≥n y Navegaci√≥n">
        <span class="icon">‚ò∞</span> <small>MEN√ö</small>
    </button>

    <div class="dashboard-wrapper">
        <nav class="sidebar" id="sidebar">
            <div class="brand">
                <img src="icon.jpg" alt="Logo" class="main-logo" onerror="this.style.display='none'">
                <div class="brand-text">
                    <span class="name">ALHADIQA</span>
                    <span class="sub">INVEST TERMINAL</span>
                </div>
            </div>

            <div class="menu-section">
                <small class="menu-title">OPERATIVA</small>
                <ul class="nav-links">
                    <li class="active"><a href="index.html">üìà Terminal de Trading</a></li>
                    <li><a href="#" id="nav-forex-smc">üõ°Ô∏è Estrategia SMC</a></li>
                    <li><a href="https://www.investing.com/economic-calendar/" target="_blank">üìÖ Calendario Econ√≥mico</a></li>
                </ul>
            </div>

            <div class="menu-section">
                <small class="menu-title">HERRAMIENTAS KIRA</small>
                <ul class="nav-links">
                    <li><a href="#" onclick="ejecutarDiagnostico()">üîç Test de Latencia</a></li>
                    <li><a href="#" onclick="alert('Historial de se√±ales en desarrollo')">üìú Registro de Alertas</a></li>
                </ul>
            </div>

            <div class="sidebar-footer">
                <div class="status-indicator">
                    <div class="dot green"></div>
                    <span>SERVIDOR: ONLINE</span>
                </div>
                <button class="close-sidebar" onclick="toggleMenu()">COLAPSAR PANEL ‚Üê</button>
            </div>
        </nav>

        <main class="main-content">
            <header id="status-banner" class="neutral">
                <div class="signal-badge" id="signal-text">ESPERANDO DATOS...</div>
            </header>

            <div class="content-grid">
                <section class="chart-area" id="main-chart"></section>

                <aside class="info-panel">
                    
                    <div class="card kira-panel" id="kira-terminal">
                        <div class="card-header">
                            <span class="tag-gold">ALGO KIRA 1.0</span>
                            <div id="session-indicator" class="session-badge">SUIZA/LONDRES</div>
                        </div>
                        
                        <div class="kira-data-grid">
                            <div class="data-box">
                                <small>SPREAD</small>
                                <span id="kira-spread" class="highlight">0.0 pips</span>
                            </div>
                            <div class="data-box">
                                <small>LOTES SNIPER</small>
                                <strong id="suggested-lot" class="highlight">0.01</strong>
                            </div>
                        </div>

                        <div id="kira-signal-box" class="kira-wait">
                            <div class="pulse-icon"></div>
                            <span id="kira-action">ESCANER ACTIVO...</span>
                        </div>

                        <div class="risk-input-group">
                            <label>BALANCE CUENTA (USD)</label>
                            <input type="number" id="kira-balance" value="1000" step="100" onchange="calcularLotaje()">
                        </div>
                    </div>

                    <div class="card selector-card">
                        <div class="selector-group">
                            <label>TEMPORALIDAD</label>
                            <div class="timeframe-grid">
                                <button class="tf-btn" onclick="cambiarTF('1m')">1M</button>
                                <button class="tf-btn" onclick="cambiarTF('5m')">5M</button>
                                <button class="tf-btn active" onclick="cambiarTF('15m')">15M</button>
                                <button class="tf-btn" onclick="cambiarTF('1h')">1H</button>
                            </div>
                        </div>

                        <div class="selector-group">
                            <label>ACTIVO SELECCIONADO</label>
                            <select id="asset-selector" class="dark-select">
                                <optgroup label="CRIPTO (WEBSOCKET LIVE)">
                                    <option value="BTC" selected>BITCOIN / USD</option>
                                    <option value="ETH">ETHEREUM / USD</option>
                                </optgroup>
                                <optgroup label="FOREX (HIGH PRECISION)">
                                    <option value="EURUSD">EUR / USD</option>
                                    <option value="GBPUSD">GBP / USD</option>
                                    <option value="USDJPY">USD / JPY</option>
                                </optgroup>
                                <optgroup label="METALES">
                                    <option value="GOLD">XAU / USD (ORO)</option>
                                </optgroup>
                            </select>
                        </div>
                    </div>

                    <div class="card price-display">
                        <div class="price-info">
                            <span id="asset-name" class="asset-title">BITCOIN</span>
                            <span id="current-price" class="price-value">$0.00</span>
                        </div>
                        <div class="rsi-bar">
                            <small>RSI (14): <span id="rsi-value">--</span></small>
                            <div class="rsi-track"><div id="rsi-fill" style="width: 50%"></div></div>
                        </div>
                    </div>

                    <div class="card smc-card" id="smc-info-card" style="display: none;">
                        <span class="label">ESTRUCTURA INSTITUCIONAL</span>
                        <div class="smc-status-box">
                            <span id="smc-status">BUSCANDO BOS...</span>
                        </div>
                    </div>

                    <details class="card settings-details">
                        <summary>‚öôÔ∏è PAR√ÅMETROS DEL ALGORITMO</summary>
                        <div class="settings-content">
                            <div class="field">
                                <label>EMA R√°pida (Cruce)</label>
                                <input type="number" id="input-ema-fast" value="20" onchange="actualizarParametros()">
                            </div>
                            <div class="field">
                                <label>EMA Media (Fuerza)</label>
                                <input type="number" id="input-ema-mid" value="50" onchange="actualizarParametros()">
                            </div>
                            <div class="field">
                                <label>EMA Lenta (Tendencia)</label>
                                <input type="number" id="input-ema-slow" value="80" onchange="actualizarParametros()">
                            </div>
                            <button class="btn-apply" onclick="cargarActivo()">REINICIAR MOTOR</button>
                        </div>
                    </details>
                </aside>
            </div>
        </main>
    </div>

    <script>
        function toggleMenu() {
            document.body.classList.toggle('menu-collapsed');
            // Redimensionar gr√°fico con retraso para esperar la animaci√≥n del CSS
            setTimeout(() => { 
                if(window.chart) {
                    window.dispatchEvent(new Event('resize'));
                }
            }, 300);
        }
    </script>
    <script src="script.js"></script>
</body>
</html>
